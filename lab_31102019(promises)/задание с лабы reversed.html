<!DOCTYPE html>
<html>
 <head>
  <script src="/j/out"></script>
  <!-- <script src="/j/barewebber"></script> -->
  <script src="/socket.io/socket.io.js"></script>
  <title>Онлайн-лекция 09.11.2019</title><meta charset="utf-8"><meta name="author" content="Ilya Gosudarev"><link rel="stylesheet" href="/css/board2"><link rel="stylesheet" href="/css/highcss_atom">
 </head>
 <body>
  <script src="/j/dblttl"></script><script src="/j/clicker"></script>
  <script src="/high.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
   <h2></h2>
  <pre class="task">
<hr>

<input type="text" id="info">

<a target="_blank" href="https://kodaktor.ru/g/dom_parse2">Хождение по ДОМу</a>

Обращение по адресу <b>https://kodaktor.ru/api/rv/abc</b>
превращает строку abc в cba. Обращение по адресу <b>https://kodaktor.ru/api/rp/abc</b> превращает строку abc в abcabc. Т.е. первый адрес обращает строку, а второй удваивает.

Используя async/await, напишите код, который по щелчку по кнопке отправляет введённую в текстовое поле строку на первый адрес, получает результат, отправляет этот результат на второй адрес и выдаёт окончательный результат.

  </pre>  
  <pre><code>
new Clicker(async () => {
  const value = document.querySelector('#info').value;
  const result1 = await fetch('https://kodaktor.ru/api/rv/' + value)
  .then(x => x.text());
  const pars = new DOMParser();
  const doc = pars.parseFromString(result1, 'text/html');
  const result2 = doc.querySelector('span').textContent;
   
  
  const result3 = await fetch('https://kodaktor.ru/api/rp/' + result2)
  .then(x=>x.text());
  const doc2 = pars.parseFromString(result3, 'text/html');
  const result4 = doc2.querySelector('span').textContent;
  document.querySelector('h2').textContent = result4;
   
}, caption='Щёлкни');   
  </code></pre>
   

  <script src="/j/execute"></script>
 </body>
</html>



<!-- 

Blue Menu командра Refresh для перезагрузки
как замена фигурных скобок в script

На забудь изменить title

-->
